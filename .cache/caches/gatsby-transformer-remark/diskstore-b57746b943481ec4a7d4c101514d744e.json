{"expireTime":9007200859288004000,"key":"transformer-remark-markdown-html-32bfbf9180a4a4c040ec7cd575c35c97-gatsby-remark-embed-gistgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-abbrgatsby-remark-imagesgatsby-remark-prismjs-","val":"<p>Did you get an NServiceBus <code class=\"language-text\">Could not enumerate all types</code> error? Then youâ€™ve come to the right place. Iâ€™ve recently started using NServiceBus for the first time in a long time. Â The initialÂ setup was great, but once I started integrating it into a really large, complex, existing app, it took a bit of re-working. Â One of the errors I ran into was a HUGE string of errors all centering around not being able to enumerate all types. Â In this case, the root cause turned out to be NServiceBus scanning every single .dll of your app looking for handlers. Â By default, it searches everything, and when that happens it can run into situations where it can break. The out of the box, greenfield developer experience works great, but if youâ€™re adding NServiceBus to an existing app, then you need to add the line below to fix the error.</p>\n<p>Basically in an existing app where youâ€™ve added NServiceBus code to handle/send messages, then you know exactly the assembly where it lives. Â Again, <strong>by default, NServiceBus scans everything, so in NServiceBus 5.0 and above, when you create the actual Bus object, you need to specify in the configuration the assemblies you want to scan.</strong> Otherwise, youâ€™ll get an â€œCould not enumerate all typesâ€ exception.Â Generally, the code is going to be in right in the webapp/console app that you are adding it to, so in that case just add:</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">var</span> config <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BusConfiguration</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// config.AllYourOtherConfigurationGoesHere</span>\n\nconfig<span class=\"token punctuation\">.</span><span class=\"token function\">AssembliesToScan</span><span class=\"token punctuation\">(</span>Assembly<span class=\"token punctuation\">.</span><span class=\"token function\">GetExecutingAssembly</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> bus <span class=\"token operator\">=</span> Bus<span class=\"token punctuation\">.</span><span class=\"token function\">Create</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>This tells NServiceBus to only scan the assembly that is currently in use (This will fix things 95% of the time, unless your consumer/sender code is in a different project and pulled in). Â Once this is configured, NServiceBus will not scan every single assembly in hopes of finding a handler somewhere, which helps a ton if you have really old assemblies that are fragile and busted. Â ğŸ™‚</p>"}