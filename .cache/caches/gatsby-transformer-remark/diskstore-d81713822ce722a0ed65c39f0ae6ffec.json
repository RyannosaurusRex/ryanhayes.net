{"expireTime":9007200859288004000,"key":"transformer-remark-markdown-html-078052bfb146f5acee833f06ea48179d-gatsby-remark-embed-gistgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-abbrgatsby-remark-imagesgatsby-remark-prismjs-","val":"<p>Recently, I ported this website to Gatsby.js. As part of it, I wanted to make sure that I tied up any loose ends and cleaned up all of my accessibility and technical issues. One great way to do that is to run a tool called <a href=\"https://webhint.io\">Webhint</a> over your website and get “hints” as to what you need to change. These hints are installed through NPM, and if you’re familiar with NPM, you probably know the node_packages folder ends up with hundreds of package dependencies. One of these dependencies ended up needing node-gyp, which is a build tool that requires a few build tools (like VC++ and python) installed on your machine, particularly if you’re on Windows. This article will explain the how to fix the error both quickly and permanently.</p>\n<p>Here’s what I ran from the command line and the error message that I received. <strong>You’ll see that it’s attempting to run node-gyp and then gives an error that it can’t find <code class=\"language-text\">VBuild.exe</code></strong>. </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">RyannosaurusRex@Bespin MINGW64 /c/git/personal/ryanhayes.net <span class=\"token punctuation\">(</span>master<span class=\"token punctuation\">)</span>\n$ <span class=\"token function\">npm</span> <span class=\"token function\">install</span>\n\n<span class=\"token operator\">></span> iltorb@2.4.2 <span class=\"token function\">install</span> C:<span class=\"token punctuation\">\\</span>git<span class=\"token punctuation\">\\</span>ryanhayes.net<span class=\"token punctuation\">\\</span>node_modules<span class=\"token punctuation\">\\</span>iltorb\n<span class=\"token operator\">></span> node ./scripts/install.js <span class=\"token operator\">||</span> node-gyp rebuild\n\ninfo looking <span class=\"token keyword\">for</span> cached prebuild @ C:<span class=\"token punctuation\">\\</span>Users<span class=\"token punctuation\">\\</span>RyannosaurusRex<span class=\"token punctuation\">\\</span>AppData<span class=\"token punctuation\">\\</span>Roaming<span class=\"token punctuation\">\\</span>npm-cache<span class=\"token punctuation\">\\</span>_prebuilds<span class=\"token punctuation\">\\</span>ff68b8-iltorb-v2.4.2-node-v67-win32-x64.tar.gz\nhttp request GET https://github.com/MayhemYDG/iltorb/releases/download/v2.4.2/iltorb-v2.4.2-node-v67-win32-x64.tar.gz\nhttp <span class=\"token number\">404</span> https://github.com/MayhemYDG/iltorb/releases/download/v2.4.2/iltorb-v2.4.2-node-v67-win32-x64.tar.gz\nWARN <span class=\"token function\">install</span> No prebuilt binaries found <span class=\"token punctuation\">(</span>target<span class=\"token operator\">=</span><span class=\"token number\">11.11</span>.0 <span class=\"token assign-left variable\">runtime</span><span class=\"token operator\">=</span>node <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>x64 <span class=\"token assign-left variable\">libc</span><span class=\"token operator\">=</span> <span class=\"token assign-left variable\">platform</span><span class=\"token operator\">=</span>win32<span class=\"token punctuation\">)</span>\n\nC:<span class=\"token punctuation\">\\</span>git<span class=\"token punctuation\">\\</span>ryanhayes.net<span class=\"token punctuation\">\\</span>node_modules<span class=\"token punctuation\">\\</span>iltorb<span class=\"token operator\">></span>if not defined npm_config_node_gyp <span class=\"token punctuation\">(</span>node <span class=\"token string\">\"C:\\Program Files<span class=\"token entity\" title=\"\\n\">\\n</span>odejs<span class=\"token entity\" title=\"\\n\">\\n</span>ode_modules<span class=\"token entity\" title=\"\\n\">\\n</span>pm<span class=\"token entity\" title=\"\\n\">\\n</span>ode_modules<span class=\"token entity\" title=\"\\n\">\\n</span>pm-lifecycle<span class=\"token entity\" title=\"\\n\">\\n</span>ode-gyp-bin<span class=\"token entity\" title=\"\\\\\">\\\\</span>..\\..<span class=\"token entity\" title=\"\\n\">\\n</span>ode_modules<span class=\"token entity\" title=\"\\n\">\\n</span>ode-gyp<span class=\"token entity\" title=\"\\b\">\\b</span>in<span class=\"token entity\" title=\"\\n\">\\n</span>ode-gyp.js\"</span> rebuild <span class=\"token punctuation\">)</span>  <span class=\"token keyword\">else</span> <span class=\"token punctuation\">(</span>node <span class=\"token string\">\"C:\\Program Files<span class=\"token entity\" title=\"\\n\">\\n</span>odejs<span class=\"token entity\" title=\"\\n\">\\n</span>ode_modules<span class=\"token entity\" title=\"\\n\">\\n</span>pm<span class=\"token entity\" title=\"\\n\">\\n</span>ode_modules<span class=\"token entity\" title=\"\\n\">\\n</span>ode-gyp<span class=\"token entity\" title=\"\\b\">\\b</span>in<span class=\"token entity\" title=\"\\n\">\\n</span>ode-gyp.js\"</span> rebuild <span class=\"token punctuation\">)</span>\nWarning: unrecognized setting VCCLCompilerTool/MultiProcessorCompilation\nWarning: unrecognized setting VCCLCompilerTool/MultiProcessorCompilation\nWarning: unrecognized setting VCCLCompilerTool/MultiProcessorCompilation\nWarning: unrecognized setting VCCLCompilerTool/MultiProcessorCompilation\nBuilding the projects <span class=\"token keyword\">in</span> this solution one at a time. To <span class=\"token builtin class-name\">enable</span> parallel build, please <span class=\"token function\">add</span> the <span class=\"token string\">\"/m\"</span> switch.\nMSBUILD <span class=\"token builtin class-name\">:</span> error MSB3428: Could not load the Visual C++ component <span class=\"token string\">\"VCBuild.exe\"</span><span class=\"token builtin class-name\">.</span> To fix this, <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token function\">install</span> the .NET Framework <span class=\"token number\">2.0</span> SDK, <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token function\">install</span> \nMicrosoft Visual Studio <span class=\"token number\">2005</span> or <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token function\">add</span> the location of the component to the system path <span class=\"token keyword\">if</span> it is installed elsewhere.  <span class=\"token punctuation\">[</span>C:<span class=\"token punctuation\">\\</span>git<span class=\"token punctuation\">\\</span>ryanhay\nes.net<span class=\"token punctuation\">\\</span>node_modules<span class=\"token punctuation\">\\</span>iltorb<span class=\"token punctuation\">\\</span>build<span class=\"token punctuation\">\\</span>binding.sln<span class=\"token punctuation\">]</span>\ngyp ERR<span class=\"token operator\">!</span> build error\ngyp ERR<span class=\"token operator\">!</span> stack Error: <span class=\"token variable\"><span class=\"token variable\">`</span>C:<span class=\"token punctuation\">\\</span>Program Files <span class=\"token punctuation\">(</span>x86<span class=\"token punctuation\">)</span><span class=\"token punctuation\">\\</span>MSBuild<span class=\"token punctuation\">\\</span><span class=\"token number\">14.0</span><span class=\"token punctuation\">\\</span>bin<span class=\"token punctuation\">\\</span>msbuild.exe<span class=\"token variable\">`</span></span> failed with <span class=\"token builtin class-name\">exit</span> code: <span class=\"token number\">1</span>\ngyp ERR<span class=\"token operator\">!</span> stack     at ChildProcess.onExit <span class=\"token punctuation\">(</span>C:<span class=\"token punctuation\">\\</span>Program Files<span class=\"token punctuation\">\\</span>nodejs<span class=\"token punctuation\">\\</span>node_modules<span class=\"token punctuation\">\\</span>npm<span class=\"token punctuation\">\\</span>node_modules<span class=\"token punctuation\">\\</span>node-gyp<span class=\"token punctuation\">\\</span>lib<span class=\"token punctuation\">\\</span>build.js:262:23<span class=\"token punctuation\">)</span>\ngyp ERR<span class=\"token operator\">!</span> stack     at ChildProcess.emit <span class=\"token punctuation\">(</span>events.js:197:13<span class=\"token punctuation\">)</span>\ngyp ERR<span class=\"token operator\">!</span> stack     at Process.ChildProcess._handle.onexit <span class=\"token punctuation\">(</span>internal/child_process.js:254:12<span class=\"token punctuation\">)</span>\ngyp ERR<span class=\"token operator\">!</span> System Windows_NT <span class=\"token number\">10.0</span>.17134\ngyp ERR<span class=\"token operator\">!</span> <span class=\"token builtin class-name\">command</span> <span class=\"token string\">\"C:<span class=\"token entity\" title=\"\\\\\">\\\\</span>Program Files<span class=\"token entity\" title=\"\\\\\">\\\\</span>nodejs<span class=\"token entity\" title=\"\\\\\">\\\\</span>node.exe\"</span> <span class=\"token string\">\"C:<span class=\"token entity\" title=\"\\\\\">\\\\</span>Program Files<span class=\"token entity\" title=\"\\\\\">\\\\</span>nodejs<span class=\"token entity\" title=\"\\\\\">\\\\</span>node_modules<span class=\"token entity\" title=\"\\\\\">\\\\</span>npm<span class=\"token entity\" title=\"\\\\\">\\\\</span>node_modules<span class=\"token entity\" title=\"\\\\\">\\\\</span>node-gyp<span class=\"token entity\" title=\"\\\\\">\\\\</span>bin<span class=\"token entity\" title=\"\\\\\">\\\\</span>node-gyp.js\"</span>\n<span class=\"token string\">\"rebuild\"</span>\ngyp ERR<span class=\"token operator\">!</span> cwd C:<span class=\"token punctuation\">\\</span>git<span class=\"token punctuation\">\\</span>ryanhayes.net<span class=\"token punctuation\">\\</span>node_modules<span class=\"token punctuation\">\\</span>iltorb\ngyp ERR<span class=\"token operator\">!</span> node -v v11.11.0\ngyp ERR<span class=\"token operator\">!</span> node-gyp -v v3.8.0\ngyp ERR<span class=\"token operator\">!</span> not ok\n<span class=\"token function\">npm</span> WARN babel-plugin-styled-components@1.10.0 requires a peer of styled-components@<span class=\"token operator\">></span><span class=\"token operator\">=</span> <span class=\"token number\">2</span> but none is installed. You must <span class=\"token function\">install</span> peer dependencies yourself.\n<span class=\"token function\">npm</span> WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@1.2.8 <span class=\"token punctuation\">(</span>node_modules<span class=\"token punctuation\">\\</span>fsevents<span class=\"token punctuation\">)</span>:\n<span class=\"token function\">npm</span> WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform <span class=\"token keyword\">for</span> fsevents@1.2.8: wanted <span class=\"token punctuation\">{</span><span class=\"token string\">\"os\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"darwin\"</span>,<span class=\"token string\">\"arch\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"any\"</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">(</span>current: <span class=\"token punctuation\">{</span><span class=\"token string\">\"os\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"win32\"</span>,<span class=\"token string\">\"arch\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"x64\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span> code ELIFECYCLE\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span> errno <span class=\"token number\">1</span>\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span> iltorb@2.4.2 install: <span class=\"token variable\"><span class=\"token variable\">`</span>node ./scripts/install.js <span class=\"token operator\">||</span> node-gyp rebuild<span class=\"token variable\">`</span></span>\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span> Exit status <span class=\"token number\">1</span>\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span>\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span> Failed at the iltorb@2.4.2 <span class=\"token function\">install</span> script.\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span> This is probably not a problem with npm. There is likely additional logging output above.\n\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span> A complete log of this run can be found in:\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span>     C:<span class=\"token punctuation\">\\</span>Users<span class=\"token punctuation\">\\</span>RyannosaurusRex<span class=\"token punctuation\">\\</span>AppData<span class=\"token punctuation\">\\</span>Roaming<span class=\"token punctuation\">\\</span>npm-cache<span class=\"token punctuation\">\\</span>_logs<span class=\"token punctuation\">\\</span><span class=\"token number\">2019</span>-04-22T03_31_15_972Z-debug.log</code></pre></div>\n<h2>The ‘Could not load the Visual C++ component “VCBuild.exe”’ solution</h2>\n<p>The error message mentions that you need to install MSBuild or Visual Studio. That works, of course, and is one solution. If you don’t need all of Visual Studio, that’s a very large footprint (7+ GB of storage) just to satisfy a small dependency like VCBuild.exe. </p>\n<p><strong>If you already have Visual Studio or the necessary tools installed, make sure you are using powershell.</strong> To swith to powershell on the linux/WSL command line, just run <code class=\"language-text\">$ powershell</code> to switch and try again.</p>\n<h2>Installing Windows Build Tools</h2>\n<p>To fix the issue without having to install Visual Studio, Microsoft has created a great npm package called <code class=\"language-text\">windows-build-tools</code>. This package allows you to compile Native Node modules, which is required by some npm packages, particularly packages that deal with Chromium and canvas.</p>\n<p>You can read the <a href=\"https://www.npmjs.com/package/windows-build-tools\">full documentation on windows-build-tools on the NPM registry page</a>.</p>\n<p>To install the tools, you can use NPM</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">npm install <span class=\"token operator\">--</span>global windows<span class=\"token operator\">-</span>build<span class=\"token operator\">-</span>tools</code></pre></div>\n<p>If you prefer yarn, here’s the install for that.</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">yarn global add windows<span class=\"token operator\">-</span>build<span class=\"token operator\">-</span>tools</code></pre></div>\n<p>Here’s the output from the run on my machine. You’ll see that it installs VCBuild.exe and related tools, but also Python as well, which is necessary for a lot of other npm packages.</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">PS</span> C:\\windows\\system32> npm install <span class=\"token operator\">--</span>global windows<span class=\"token operator\">-</span>build<span class=\"token operator\">-</span>tools\n\n> windows<span class=\"token operator\">-</span>build<span class=\"token operator\">-</span>tools@5<span class=\"token punctuation\">.</span>1<span class=\"token punctuation\">.</span>0 postinstall C:\\Users\\RyannosaurusRex\\AppData\\Roaming\\npm\\node_modules\\windows<span class=\"token operator\">-</span>build<span class=\"token operator\">-</span>tools\n> node <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>dist<span class=\"token operator\">/</span>index<span class=\"token punctuation\">.</span>js\n\n\n\nDownloading python<span class=\"token operator\">-</span>2<span class=\"token punctuation\">.</span>7<span class=\"token punctuation\">.</span>15<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>msi\n<span class=\"token punctuation\">[</span>>                                            <span class=\"token punctuation\">]</span> 0<span class=\"token punctuation\">.</span>0<span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>0 B<span class=\"token operator\">/</span>s<span class=\"token punctuation\">)</span>\nDownloaded python<span class=\"token operator\">-</span>2<span class=\"token punctuation\">.</span>7<span class=\"token punctuation\">.</span>15<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>msi<span class=\"token punctuation\">.</span> Saved to C:\\Users\\RyannosaurusRex\\<span class=\"token punctuation\">.</span>windows<span class=\"token operator\">-</span>build<span class=\"token operator\">-</span>tools\\python<span class=\"token operator\">-</span>2<span class=\"token punctuation\">.</span>7<span class=\"token punctuation\">.</span>15<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>msi<span class=\"token punctuation\">.</span>\nDownloading vs_BuildTools<span class=\"token punctuation\">.</span>exe\n<span class=\"token punctuation\">[</span>>                                            <span class=\"token punctuation\">]</span> 0<span class=\"token punctuation\">.</span>0<span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>0 B<span class=\"token operator\">/</span>s<span class=\"token punctuation\">)</span>\nDownloaded vs_BuildTools<span class=\"token punctuation\">.</span>exe<span class=\"token punctuation\">.</span> Saved to C:\\Users\\RyannosaurusRex\\<span class=\"token punctuation\">.</span>windows<span class=\"token operator\">-</span>build<span class=\"token operator\">-</span>tools\\vs_BuildTools<span class=\"token punctuation\">.</span>exe<span class=\"token punctuation\">.</span>\n\nStarting installation<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nLaunched installers<span class=\"token punctuation\">,</span> now waiting <span class=\"token keyword\">for</span> them to finish<span class=\"token punctuation\">.</span>\nThis will likely take some time <span class=\"token operator\">-</span> please be patient<span class=\"token operator\">!</span>\n\nStatus <span class=\"token keyword\">from</span> the installers:\n<span class=\"token operator\">--</span>-<span class=\"token operator\">--</span>-<span class=\"token operator\">--</span>-<span class=\"token operator\">-</span> Visual Studio Build Tools <span class=\"token operator\">--</span>-<span class=\"token operator\">--</span>-<span class=\"token operator\">--</span>-<span class=\"token operator\">-</span>\n2019<span class=\"token operator\">-</span>04<span class=\"token operator\">-</span>21T23:32:57 : Verbose : <span class=\"token namespace\">[InstalledProductsProviderImpl]</span>: Stream was closed\n2019<span class=\"token operator\">-</span>04<span class=\"token operator\">-</span>21T23:32:57 : Verbose : <span class=\"token namespace\">[InstallerImpl]</span>: Rpc connection was closed<span class=\"token punctuation\">.</span>\n2019<span class=\"token operator\">-</span>04<span class=\"token operator\">-</span>21T23:32:57 : Verbose : <span class=\"token namespace\">[InstallerImpl]</span>: Stream was closed\n2019<span class=\"token operator\">-</span>04<span class=\"token operator\">-</span>21T23:32:57 : Verbose : Completed notifying all clients that the update is starting\n2019<span class=\"token operator\">-</span>04<span class=\"token operator\">-</span>21T23:32:57 : Verbose : Updating installer <span class=\"token namespace\">[bootstrapperArguments: /finalizeInstall install --in C:\\ProgramData\\Microsoft\\VisualStudio\\Packages\\_bootstrapper\\vs_setup_bootstrapper_201904212332293329.json --norestart --quiet --includeRecommended --add Microsoft.VisualStudio.Workload.VCTools --locale en-US --activityId 56083b59-412f-473c-bdae-1976d5623e0d]</span>\n<span class=\"token operator\">--</span>-<span class=\"token operator\">--</span>-<span class=\"token operator\">--</span>-<span class=\"token operator\">--</span>-<span class=\"token operator\">--</span>-<span class=\"token operator\">--</span>-<span class=\"token operator\">-</span> Python <span class=\"token operator\">--</span>-<span class=\"token operator\">--</span>-<span class=\"token operator\">--</span>-<span class=\"token operator\">--</span>-<span class=\"token operator\">--</span>-<span class=\"token operator\">--</span>-<span class=\"token operator\">--</span>\nSuccessfully installed Python 2<span class=\"token punctuation\">.</span>7</code></pre></div>\n<h2>Wrapping up</h2>\n<p>While the error message is fairly clear, the solution it proposed was not a great one. Visual Studio is a very large dependency to take, particularly for a lightweight Gatsby site. Thankfully, <a href=\"https://www.npmjs.com/package/windows-build-tools\">windows-build-tools</a> allowed me to install just the dependencies that I needed without the extra bloat. </p>\n<p>Hope this helped you!</p>"}