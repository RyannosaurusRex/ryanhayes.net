{"expireTime":9007200859288004000,"key":"transformer-remark-markdown-ast-0ee540f502e36235edd9fdf0bdba60d5-gatsby-remark-embed-gistgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-abbrgatsby-remark-imagesgatsby-remark-prismjs-","val":{"type":"root","children":[{"type":"paragraph","children":[{"type":"text","value":"I’ve been working with MVC3 and Razor lately.  It’s been absolutely great.  I’ve not used MVC to build a production app until now, and it’s been killer fast building things out quickly.  Previously, I’ve just used regular old objects like are in the starter projects to play around with my applications as the “M” in my MVC.  With these, you can use the System.ComponentModel.DataAnnotations to decorate your classes with validation, labels, datatypes, field types and more that are used in MVC views to dynamically create your UI.  Now, though, I’m building a pretty big application that I’ll be putting out for a longer term, and will use SQL Server for the back-end with Entity Framework 4.0 entities as my model. The problem with this is that entity models are dynamically generated, and don’t contain annotations of their own.","position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":832,"offset":831},"indent":[]}},{"type":"html","value":"<!--more-->","position":{"start":{"line":1,"column":832,"offset":831},"end":{"line":1,"column":843,"offset":842},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":843,"offset":842},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Here’s an example of the DataAnnotations in a typical model:","position":{"start":{"line":3,"column":1,"offset":844},"end":{"line":3,"column":61,"offset":904},"indent":[]}}],"position":{"start":{"line":3,"column":1,"offset":844},"end":{"line":3,"column":61,"offset":904},"indent":[]}},{"type":"html","value":"<pre name=\"code\" class=\"c-sharp\">public class LogOnModel\n{\n    [Required]\n    [Display(Name = \"User name\")]\n    public string UserName { get; set; }\n\n    [Required]\n    [DataType(DataType.Password)]\n    [Display(Name = \"Password\")]\n    public string Password { get; set; }\n\n    [Display(Name = \"Remember me?\")]\n    public bool RememberMe { get; set; }\n}</pre>","position":{"start":{"line":5,"column":1,"offset":906},"end":{"line":18,"column":8,"offset":1265},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Since entities are regenerated often (meaning annotating the entities directly will result in your changes being wiped out pretty quickly), but are the preferred way of working with databases, ","position":{"start":{"line":20,"column":1,"offset":1267},"end":{"line":20,"column":194,"offset":1460},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"what’s the best way to go about annotating the entities so they work seamlessly in the MVC framework?","position":{"start":{"line":20,"column":196,"offset":1462},"end":{"line":20,"column":297,"offset":1563},"indent":[]}}],"position":{"start":{"line":20,"column":194,"offset":1460},"end":{"line":20,"column":299,"offset":1565},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":1267},"end":{"line":20,"column":299,"offset":1565},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"I recently asked this question on ","position":{"start":{"line":22,"column":1,"offset":1567},"end":{"line":22,"column":35,"offset":1601},"indent":[]}},{"type":"link","title":null,"url":"https://stackoverflow.com/questions/4915957/using-system-componentmodel-dataannotations-with-entity-framework-4-0/","children":[{"type":"text","value":"StackOverflow","position":{"start":{"line":22,"column":36,"offset":1602},"end":{"line":22,"column":49,"offset":1615},"indent":[]}}],"position":{"start":{"line":22,"column":35,"offset":1601},"end":{"line":22,"column":166,"offset":1732},"indent":[]}},{"type":"text","value":", and Austin Lamb of the Microsoft Silverlight team was kind enough to let me know how this is done in the Silverlight world, which ended up working seamlessly with MVC.  See, when you generate entities, they are created as partial classes.  This means that you can extend them by creating another partial class for each of the entity classes.  This gets us around the problem of the regenerating entities wiping out any DataAnnotations, since partial classes we create manually aren’t regenerated by the T4 template that creates the entities.  Now, can we just annotate the fields straight up in the partial class we manually create?  Well, not directly.  The trick here, as Austin points out, is to use a ","position":{"start":{"line":22,"column":166,"offset":1732},"end":{"line":22,"column":873,"offset":2439},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"MetadataType","position":{"start":{"line":22,"column":875,"offset":2441},"end":{"line":22,"column":887,"offset":2453},"indent":[]}}],"position":{"start":{"line":22,"column":873,"offset":2439},"end":{"line":22,"column":889,"offset":2455},"indent":[]}},{"type":"text","value":" class that holds the DataAnnotations.  This MetadataType class, that corresponds to a single entity class, is applied to the partial class you manually created, which then links everything up.  I know it’s hard to visualize by my typing this out in a paragraph, so I’ll give you code he gave me.  Below is the partial class and MetadataType class that you need to create under the assumption you want to add DataAnnotations to the Person class’ FirstName field:","position":{"start":{"line":22,"column":889,"offset":2455},"end":{"line":22,"column":1351,"offset":2917},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1567},"end":{"line":22,"column":1351,"offset":2917},"indent":[]}},{"type":"html","value":"<pre name=\"code\" class=\"c-sharp\">[MetadataType(typeof(PersonMetadata))]\npublic partial class Person {\n  // Note this class has nothing in it.  It's just here to add the class-level attribute.\n}\n\npublic class PersonMetadata {\n  // Name the field the same as EF named the property - \"FirstName\" for example.\n  // Also, the type needs to match.  Basically just redeclare it.\n  // Note that this is a field.  I think it can be a property too, but fields definitely should work.\n\n   [Required]\n   [Display(Name = \"First Name\")]\n   public string FirstName;\n}</pre>","position":{"start":{"line":24,"column":1,"offset":2919},"end":{"line":37,"column":8,"offset":3477},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Once you have this set up, the DataAnnotations will show through even if you use an Entity Framework model as the model for your MVC application.  Pretty slick, eh?  If you want to read the whole article then go ","position":{"start":{"line":39,"column":1,"offset":3479},"end":{"line":39,"column":213,"offset":3691},"indent":[]}},{"type":"link","title":null,"url":"https://stackoverflow.com/questions/4915957/using-system-componentmodel-dataannotations-with-entity-framework-4-0/","children":[{"type":"text","value":"here","position":{"start":{"line":39,"column":214,"offset":3692},"end":{"line":39,"column":218,"offset":3696},"indent":[]}}],"position":{"start":{"line":39,"column":213,"offset":3691},"end":{"line":39,"column":335,"offset":3813},"indent":[]}},{"type":"text","value":".  Don’t forget to upvote Adam’s post as it’s helped me a ton, and if this post has helped you, it’s only because of him.  Enjoy!","position":{"start":{"line":39,"column":335,"offset":3813},"end":{"line":39,"column":464,"offset":3942},"indent":[]}}],"position":{"start":{"line":39,"column":1,"offset":3479},"end":{"line":39,"column":464,"offset":3942},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Source:","position":{"start":{"line":41,"column":3,"offset":3946},"end":{"line":41,"column":10,"offset":3953},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":3944},"end":{"line":41,"column":12,"offset":3955},"indent":[]}},{"type":"text","value":" S","position":{"start":{"line":41,"column":12,"offset":3955},"end":{"line":41,"column":14,"offset":3957},"indent":[]}},{"type":"link","title":null,"url":"https://stackoverflow.com/questions/4915957/using-system-componentmodel-dataannotations-with-entity-framework-4-0/","children":[{"type":"text","value":"tackOverflow.com","position":{"start":{"line":41,"column":15,"offset":3958},"end":{"line":41,"column":31,"offset":3974},"indent":[]}}],"position":{"start":{"line":41,"column":14,"offset":3957},"end":{"line":41,"column":148,"offset":4091},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":3944},"end":{"line":41,"column":148,"offset":4091},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":41,"column":148,"offset":4091}}}}